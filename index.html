<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Registro de Asistencia</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { font-family: Arial; background:#f5f5f5; padding:20px }
.card {
  max-width:420px; margin:auto; background:white;
  padding:24px; border-radius:10px;
}
input, button {
  width:100%; padding:14px; margin-top:14px;
  font-size:16px;
}
button { background:#000; color:white; border:none }
</style>
</head>

<body>
<div class="card">
  <h3 id="info">Cargando información…</h3>
  <input id="codigo" placeholder="Cédula (10 dígitos)" maxlength="10">
  <button id="btn" disabled>Registrar asistencia</button>
  <p id="msg"></p>
</div>

<script>
const params = new URLSearchParams(location.search);
const codGym = params.get("cod_gym");

const SHEET_ID = "1Xgy4knXFneFKBVGwXveUoHdiQIeV8i_G1J8CwMbyxBo";
const QUERY = encodeURIComponent(
  `select B, F, G where A='${codGym}'`
);

const URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tq=${QUERY}`;

fetch(URL)
  .then(r => r.text())
  .then(t => {
    const json = JSON.parse(t.substr(47).slice(0, -2));
    const row = json.table.rows[0].c;

    document.getElementById("info").innerHTML = `
      Vas a registrar tu asistencia en<br><br>
      <strong>${row[0].v}</strong><br><br>
      Precio normal por clase: $${row[1].v}<br>
      Precio preferencial APP: $${row[2].v}
    `;
  });

const input = document.getElementById("codigo");
const btn = document.getElementById("btn");

input.oninput = () => {
  btn.disabled = !/^\d{10}$/.test(input.value);
};

btn.onclick = () => {
  document.getElementById("msg").innerText =
    "✔️ Asistencia registrada (demo)";
};
</script>
</body>
</html>
